<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Alex Fennell" />
    
    
    <title>Weight Training Classification</title>

        <script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/readthedown-0.1/readthedown.css" rel="stylesheet" />
        <link href="site_libs/readthedown-0.1/readthedown_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/readthedown-0.1/readthedown.js"></script>
    
    
        <style type="text/css">code{white-space: pre;}</style>
    <style type="text/css">
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
          background-color: #ffffff;
          color: #a0a0a0;
        }
      pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
      div.sourceCode
        { color: #1f1c1b; background-color: #ffffff; }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      code span { color: #1f1c1b; } /* Normal */
      code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
      code span.an { color: #ca60ca; } /* Annotation */
      code span.at { color: #0057ae; } /* Attribute */
      code span.bn { color: #b08000; } /* BaseN */
      code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
      code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
      code span.ch { color: #924c9d; } /* Char */
      code span.cn { color: #aa5500; } /* Constant */
      code span.co { color: #898887; } /* Comment */
      code span.cv { color: #0095ff; } /* CommentVar */
      code span.do { color: #607880; } /* Documentation */
      code span.dt { color: #0057ae; } /* DataType */
      code span.dv { color: #b08000; } /* DecVal */
      code span.er { color: #bf0303; text-decoration: underline; } /* Error */
      code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
      code span.fl { color: #b08000; } /* Float */
      code span.fu { color: #644a9b; } /* Function */
      code span.im { color: #ff5500; } /* Import */
      code span.in { color: #b08000; } /* Information */
      code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
      code span.op { color: #1f1c1b; } /* Operator */
      code span.ot { color: #006e28; } /* Other */
      code span.pp { color: #006e28; } /* Preprocessor */
      code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
      code span.sc { color: #3daee9; } /* SpecialChar */
      code span.ss { color: #ff5500; } /* SpecialString */
      code span.st { color: #bf0303; } /* String */
      code span.va { color: #0057ae; } /* Variable */
      code span.vs { color: #bf0303; } /* VerbatimString */
      code span.wa { color: #bf0303; } /* Warning */
    </style>
    
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
         <!-- readthedown start -->   
   <div id="content" data-toggle="wy-nav-shift">
     <nav id="nav-top" role="navigation" aria-label="top navigation">
       <a role="button" href="#" data-toggle="wy-nav-top"><span class="glyphicon glyphicon-menu-hamburger"></span></a>
     </nav>
         
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">Weight Training Classification</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="index.html">Navigation</a>
      </li>
      <li>
        <a href="README.html">README</a>
      </li>
      <li>
        <a href="Classification_script.html">Weight Training Classification</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">Weight Training Classification</h1>
      
         <!-- readthedown authors -->
   <div id="sidebar">
    <h2><a href="#content">Weight Training Classification</a></h2>
    <div id="toc">
      <ul>
      <li><a href="#synopsis">Synopsis</a></li>
      <li><a href="#read-in-the-data">Read in the Data</a></li>
      <li><a href="#assessing-missing-data">Assessing missing data</a>
      <ul>
      <li><a href="#removing-missing-values">Removing Missing
      Values</a></li>
      <li><a href="#keeping-accelerometer-data">Keeping accelerometer
      data</a></li>
      <li><a href="#correlated-predictors">Correlated
      Predictors</a></li>
      <li><a href="#near-zero-variance">Near Zero Variance</a></li>
      <li><a href="#validation-data-split">Validation data
      split</a></li>
      </ul></li>
      <li><a href="#model-analysis">Model analysis</a>
      <ul>
      <li><a href="#data-preprocessing">Data Preprocessing</a></li>
      <li><a href="#random-forest-model-fit">Random Forest Model
      Fit</a></li>
      <li><a href="#optimal-mtry">Optimal mtry</a></li>
      <li><a href="#variable-importance">Variable Importance</a></li>
      <li><a href="#principal-component-analysis">Principal Component
      Analysis</a></li>
      </ul></li>
      <li><a href="#model-fit-evaluation">Model Fit Evaluation</a>
      <ul>
      <li><a
      href="#confusion-matrix-caret-hold-out-cross-validation-data-set">Confusion
      matrix-caret hold out cross validation data set</a></li>
      <li><a href="#confusion-matrix-validation-data-set">Confusion
      matrix-validation data set</a></li>
      </ul></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
    </div>
    <div id="postamble" data-toggle="wy-nav-shift" class="status">
                  <p class="author"><span class="glyphicon glyphicon-user"></span> Alex
Fennell</p>
                      </div>
   </div>
     

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div id="main">
<div id="synopsis" class="section level1">
<h1>Synopsis</h1>
<p>The goal of this project is to correctly classify the quality of
physical activity an individual carried out based on accelerometer
collected from the belt, forearm, arm, and dumbbell. There were 5
different ways in which the exercise was carried out. It was done either
exactly according to the specification (Class A), throwing the elbows to
the front (Class B), lifting the dumbbell only halfway (Class C),
lowering the dumbbell only halfway (Class D) and throwing the hips to
the front (Class E). Class A is the correct manner in which the exercise
should be carried out, while the other classes are common errors. Using
the accelerometer data I was able to create a random forest model that
classified this information into the 5 desired classes with 98 percent
accuracy.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vip)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MLmetrics)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreach)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code></pre></div>
</div>
<div id="read-in-the-data" class="section level1">
<h1>Read in the Data</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#train data location</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>fileurl<span class="ot">&lt;-</span><span class="st">&quot;https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;fittrain.csv&quot;</span>)){</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">download.file</span>(fileurl,<span class="st">&quot;fittrain.csv&quot;</span>,<span class="at">method=</span><span class="st">&quot;curl&quot;</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#test data location</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>fileurl<span class="ot">&lt;-</span><span class="st">&quot;https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv&quot;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="st">&quot;fittest.csv&quot;</span>)){</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">download.file</span>(fileurl,<span class="st">&quot;fittest.csv&quot;</span>,<span class="at">method=</span><span class="st">&quot;curl&quot;</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co"># The data sets had many entries that were spaces (&quot;&quot;) and thus I specified these</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># to be missing values (NA)</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>fit_train<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;fittrain.csv&quot;</span>,<span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;&quot;</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>fit_test<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;fittest.csv&quot;</span>,<span class="at">na.strings =</span> <span class="fu">c</span>(<span class="st">&quot;NA&quot;</span>,<span class="st">&quot;&quot;</span>))</span></code></pre></div>
</div>
<div id="assessing-missing-data" class="section level1">
<h1>Assessing missing data</h1>
<p>The first thing I want to do is assess the amount of missing data, so
I know if there are certain predictors I should remove, or I should
implement an imputation technique.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">colSums</span>(<span class="fu">is.na</span>(fit_train)),<span class="at">n=</span><span class="dv">20</span>)</span></code></pre></div>
<pre><code>##                    X            user_name raw_timestamp_part_1 
##                    0                    0                    0 
## raw_timestamp_part_2       cvtd_timestamp           new_window 
##                    0                    0                    0 
##           num_window            roll_belt           pitch_belt 
##                    0                    0                    0 
##             yaw_belt     total_accel_belt   kurtosis_roll_belt 
##                    0                    0                19216 
##  kurtosis_picth_belt    kurtosis_yaw_belt   skewness_roll_belt 
##                19216                19216                19216 
## skewness_roll_belt.1    skewness_yaw_belt        max_roll_belt 
##                19216                19216                19216 
##       max_picth_belt         max_yaw_belt 
##                19216                19216</code></pre>
<p>Given a good number of these predictors are columns of missing
values, I will go ahead and remove any predictor that is more than 95%
missing values.</p>
<div id="removing-missing-values" class="section level2">
<h2>Removing Missing Values</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>threshold<span class="ot">=</span>.<span class="dv">95</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>trainfilt<span class="ot">&lt;-</span>fit_train[,<span class="fu">colSums</span>(<span class="fu">is.na</span>(fit_train))<span class="sc">&lt;</span>(<span class="fu">nrow</span>(fit_train)<span class="sc">*</span>threshold)]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>testfilt<span class="ot">&lt;-</span>fit_test[,<span class="fu">colSums</span>(<span class="fu">is.na</span>(fit_test))<span class="sc">&lt;</span>(<span class="fu">nrow</span>(fit_test)<span class="sc">*</span>threshold)]</span></code></pre></div>
</div>
<div id="keeping-accelerometer-data" class="section level2">
<h2>Keeping accelerometer data</h2>
<p>I am only using data from the accelerometers, as I am interested in
assessing whether the acelerometers alone are enough to classify the
quality with which an exercise is carried out. As a result, I will
remove columns that contain other information.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>trainfilt<span class="ot">&lt;-</span>trainfilt[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>testfilt<span class="ot">&lt;-</span>testfilt[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>trainfilt<span class="sc">$</span>classe<span class="ot">&lt;-</span><span class="fu">as.factor</span>(trainfilt<span class="sc">$</span>classe)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>testfilt<span class="sc">$</span>classe<span class="ot">&lt;-</span><span class="fu">as.factor</span>(testfilt<span class="sc">$</span>classe)</span></code></pre></div>
</div>
<div id="correlated-predictors" class="section level2">
<h2>Correlated Predictors</h2>
<p>The next step in understanding the data is to look at correlations
among the predictors. If variables are highly related to each other, it
may be worthwhile to remove them or do some dimensionality reduction
such as PCA. I use a correlation threshold of .75 here so as to only
examine the most highly correlated predictors.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cormat<span class="ot">&lt;-</span>trainfilt<span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_if</span>(is.numeric)<span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()<span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rcorr</span>(<span class="at">type=</span><span class="st">&#39;pearson&#39;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>highcor<span class="ot">&lt;-</span><span class="fu">findCorrelation</span>(cormat<span class="sc">$</span>r,<span class="at">cutoff =</span> <span class="fl">0.75</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cormat<span class="sc">$</span>r[highcor,highcor])</span></code></pre></div>
<pre><code>##  [1] &quot;accel_belt_z&quot;      &quot;roll_belt&quot;         &quot;accel_belt_y&quot;     
##  [4] &quot;accel_arm_y&quot;       &quot;total_accel_belt&quot;  &quot;accel_dumbbell_z&quot; 
##  [7] &quot;accel_belt_x&quot;      &quot;pitch_belt&quot;        &quot;magnet_dumbbell_x&quot;
## [10] &quot;accel_dumbbell_y&quot;  &quot;magnet_dumbbell_y&quot; &quot;accel_arm_x&quot;      
## [13] &quot;accel_dumbbell_x&quot;  &quot;accel_arm_z&quot;       &quot;magnet_arm_y&quot;     
## [16] &quot;magnet_belt_z&quot;     &quot;accel_forearm_y&quot;   &quot;gyros_forearm_y&quot;  
## [19] &quot;gyros_dumbbell_x&quot;  &quot;gyros_dumbbell_z&quot;  &quot;gyros_arm_x&quot;</code></pre>
<p>It is not surprising that there are many correlated predictors given
that these are complex movements that require coordination from many
parts of the body. Given this, it seems inappropriate to remove
variables. Therefore I will go forward with a PCA technique in order to
reduce the dimensionality of the data while still retaining the most
informative aspects of the data.</p>
</div>
<div id="near-zero-variance" class="section level2">
<h2>Near Zero Variance</h2>
<p>Next I will examine the data set to determine if there are any
uninformative predictors and remove them if that is the case.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>nzv<span class="ot">&lt;-</span><span class="fu">nearZeroVar</span>(trainfilt,<span class="at">saveMetrics =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">zeroVar=</span><span class="fu">sum</span>(nzv<span class="sc">$</span>zeroVar<span class="sc">==</span><span class="cn">TRUE</span>), <span class="at">NZV=</span><span class="fu">sum</span>(nzv<span class="sc">$</span>nzv<span class="sc">==</span><span class="cn">TRUE</span>))</span></code></pre></div>
<pre><code>##   zeroVar NZV
## 1       0   0</code></pre>
<p>There are no uninformative predictors, so the data is ready for
modelling.</p>
</div>
<div id="validation-data-split" class="section level2">
<h2>Validation data split</h2>
<p>Before modelling, I split the training data set to include a
validation set so the model does not overfit.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>samp<span class="ot">&lt;-</span><span class="fu">createDataPartition</span>(<span class="at">y=</span>trainfilt<span class="sc">$</span>classe,<span class="at">p=</span>.<span class="dv">8</span>,<span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>training<span class="ot">&lt;-</span>trainfilt[samp,]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>validation<span class="ot">&lt;-</span>trainfilt[<span class="sc">-</span>samp,]</span></code></pre></div>
</div>
</div>
<div id="model-analysis" class="section level1">
<h1>Model analysis</h1>
<p>The model I am going to use is a random forest model since these
typically have superior performance when it comes to classification. I
am using a repeated cross validation procedure with 10 folds, and 3
repeats to get a stable model that minimizes overtraining. I will do a
grid search to find the optimal value for the mtry parameter. This
parameter corresponds to the number of variables randomly sampled as
candidates at each split. I center and scale all the predictors and then
do a pca selecting the components that account for 95% of the variance.
I use a tree size of 250 as this is enough to produce stable accuracy
and is not overly computationally intensive. Model performance will be
assessed on its accuracy.</p>
<div id="data-preprocessing" class="section level2">
<h2>Data Preprocessing</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>control<span class="ot">&lt;-</span><span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">&#39;repeatedcv&#39;</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">number=</span><span class="dv">10</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">classProbs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">summaryFunction =</span> multiClassSummary,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">allowParallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">savePredictions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">search=</span><span class="st">&#39;grid&#39;</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>                      <span class="at">verboseIter =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>tunevals<span class="ot">&lt;-</span><span class="fu">expand.grid</span>(<span class="at">.mtry=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>))</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="co">#preprocess all datasets</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>trainpre<span class="ot">&lt;-</span><span class="fu">preProcess</span>(training,<span class="at">method=</span><span class="fu">c</span>(<span class="st">&#39;center&#39;</span>,<span class="st">&#39;scale&#39;</span>,<span class="st">&#39;pca&#39;</span>),<span class="at">thresh=</span>.<span class="dv">95</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>trainpca<span class="ot">&lt;-</span><span class="fu">predict</span>(trainpre,training)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>valpca<span class="ot">&lt;-</span><span class="fu">predict</span>(trainpre,validation)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>testpca<span class="ot">&lt;-</span><span class="fu">predict</span>(trainpre,testfilt)</span></code></pre></div>
</div>
<div id="random-forest-model-fit" class="section level2">
<h2>Random Forest Model Fit</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Parallelize the random forest process</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>cluster<span class="ot">&lt;-</span><span class="fu">makeCluster</span>(<span class="fu">detectCores</span>()<span class="sc">-</span><span class="dv">6</span>) </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cluster)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    rfmod<span class="ot">&lt;-</span><span class="fu">train</span>(classe<span class="sc">~</span>.,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data=</span>trainpca,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method=</span><span class="st">&#39;rf&#39;</span>,</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ntree=</span><span class="dv">250</span>,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">tuneGrid=</span>tunevals,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">verbose=</span><span class="cn">TRUE</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">metric=</span><span class="st">&#39;Accuracy&#39;</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">trControl=</span>control)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">stopCluster</span>(cluster)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoSEQ</span>()</span></code></pre></div>
</div>
<div id="optimal-mtry" class="section level2">
<h2>Optimal mtry</h2>
<p>This plot shows how the mtry value affects the cross validation
accuracy for the model.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rfmod)</span></code></pre></div>
<p><img src="Classification_script_files/figure-html/plot%20of%20parameter%20optimization-1.png" width="768" /></p>
<p>This plot shows that an mtry value of 3 results in the highest
accuracy on the held out cross validation sets.</p>
</div>
<div id="variable-importance" class="section level2">
<h2>Variable Importance</h2>
<p>Using the vip plot we can assess what the most valuable predictors
are.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vip</span>(rfmod)</span></code></pre></div>
<p><img src="Classification_script_files/figure-html/vip%20plot-1.png" width="768" /></p>
<p>The most important predictor appears to be PC8, so let’s examine that
to see what this component is capturing.</p>
</div>
<div id="principal-component-analysis" class="section level2">
<h2>Principal Component Analysis</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the pca loadings into an objects that will work with ggplot2</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>traincomp<span class="ot">&lt;-</span><span class="fu">melt</span>(trainpre<span class="sc">$</span>rotation)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(traincomp)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Original_Var&quot;</span>,<span class="st">&quot;Component&quot;</span>,<span class="st">&quot;Magnitude&quot;</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>pcaplot<span class="ot">&lt;-</span>traincomp <span class="sc">%&gt;%</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Component <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">&quot;PC&quot;</span>, <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">14</span>,<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">5</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Magnitude, Original_Var, <span class="at">fill =</span> Original_Var)) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Component, <span class="at">nrow =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">&quot;Strength of Contribution&quot;</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>pcaplot</span></code></pre></div>
<p><img src="Classification_script_files/figure-html/pca%20plot-1.png" width="864" /></p>
<p>This figure shows the five most informative principal components and
the contributions of each predictor into each principal component. Since
each component is influenced in some way by each predictor, one way to
understand what a component is capturing is by examining the tallest
bars in the plot to see what predictors are contributing the most to
each component. For example in PC 14 gyroscopic information from the
belt in the z and y planes are the largest contributors. Given that one
of the classes of exercises involved movement of the hips it makes sense
this component would be useful for classification. The following plot
shows the most informative predictors that contribute to these
components to provide a clearer picture of what these components are
capturing.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pcaplot2<span class="ot">&lt;-</span>traincomp <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Component <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">&quot;PC&quot;</span>, <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">14</span>,<span class="dv">12</span>,<span class="dv">1</span>,<span class="dv">5</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Component) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">8</span>, <span class="fu">abs</span>(Magnitude)) <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Original_Var =</span> <span class="fu">reorder_within</span>(Original_Var, <span class="fu">abs</span>(Magnitude), Component)) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">abs</span>(Magnitude), Original_Var, <span class="at">fill =</span> Magnitude)) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>Component, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">title=</span><span class="st">&quot;Predictor Contribution  to  Top Five Principal Components&quot;</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">&quot;Absolute value of contribution&quot;</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">&quot;Strength of </span><span class="sc">\n</span><span class="st">Contribution&quot;</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>     ) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">hjust=</span>.<span class="dv">5</span>))</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>pcaplot2</span></code></pre></div>
<p><img src="Classification_script_files/figure-html/Most%20significant%20predictors%20in%20components-1.png" width="960" /></p>
<p>The strongest predictors that were combined in the 5 most informative
principal components are presented in the figure above. Green and yellow
colors indicate positive values, while blue and purple colors indicate
negative values. The strongest component, PC8, is capturing gyroscopic
information from the dumbbell, and the overall acceleration in the
forearm arm and forearm in z plane, vs. overall acceleration of the arm,
in addition to the magnitude and acceleration of the forearm in the x
plane. It makes sense that this is the most important component given it
captures so much information about the dumbbell position and the
forearm. Both of these are key factors in delineating between correctly
and incorrectly carrying out the bicep curl.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(trainpca,<span class="fu">aes</span>(<span class="at">x=</span>PC8,<span class="at">y=</span>PC14,<span class="at">color=</span>classe))<span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">name=</span><span class="st">&quot;Exercise Type&quot;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Correct (A)&quot;</span>,<span class="st">&quot;Elbows Front (B)&quot;</span>,<span class="st">&quot;Half Curl Lift (C)&quot;</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="st">&quot;Half Curl Lower (D)&quot;</span>,<span class="st">&quot;Hips Front (E)&quot;</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">type=</span><span class="st">&quot;qual&quot;</span>,<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>)</span></code></pre></div>
<p><img src="Classification_script_files/figure-html/PCA%20components%20together-1.png" width="768" /></p>
<p>This plot is another way to demonstrate what the two most important
principal components are capturing. Since there are so many components
and many outcome categories, there are no explicit cutoffs where one
component perfectly captures one exercise type. Instead there is a much
more complex interaction among the components. PC14 does a relatively
good job of capturing some component of exercises where the hips move
forward, and the lowering of the dumbbell from halfway. Since PC14 is
mainly dominated by gyroscopic information from the belt it makes sense
that it would be better at classifying these two types of activities. In
the next section I will examine the quality of the model fits.</p>
</div>
</div>
<div id="model-fit-evaluation" class="section level1">
<h1>Model Fit Evaluation</h1>
<div id="confusion-matrix-caret-hold-out-cross-validation-data-set"
class="section level2">
<h2>Confusion matrix-caret hold out cross validation data set</h2>
<p>To assess the model fit I will be using confusion matrices. First I
will examine the model fit to the held out re-samples in the caret cross
validation procedure. Then I will examine the model performance against
the validation set that I set aside before beginning the modelling.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(rfmod)</span></code></pre></div>
<pre><code>## Cross-Validated (10 fold, repeated 3 times) Confusion Matrix 
## 
## (entries are percentual average cell counts across resamples)
##  
##           Reference
## Prediction    A    B    C    D    E
##          A 28.2  0.3  0.1  0.0  0.0
##          B  0.1 18.8  0.2  0.0  0.1
##          C  0.1  0.2 17.0  0.7  0.2
##          D  0.0  0.0  0.2 15.6  0.1
##          E  0.0  0.0  0.0  0.0 18.0
##                             
##  Accuracy (average) : 0.9767</code></pre>
<p>On the cross validation set within the caret procedure, the model is
quite accurate (~97%) with few observations off the diagonals.</p>
</div>
<div id="confusion-matrix-validation-data-set" class="section level2">
<h2>Confusion matrix-validation data set</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(rfmod,valpca),valpca<span class="sc">$</span>classe)</span></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1111   10    1    1    0
##          B    1  744   12    0    0
##          C    2    4  657   25    7
##          D    2    0   12  617    6
##          E    0    1    2    0  708
## 
## Overall Statistics
##                                          
##                Accuracy : 0.9781         
##                  95% CI : (0.973, 0.9824)
##     No Information Rate : 0.2845         
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
##                                          
##                   Kappa : 0.9723         
##                                          
##  Mcnemar&#39;s Test P-Value : NA             
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9955   0.9802   0.9605   0.9596   0.9820
## Specificity            0.9957   0.9959   0.9883   0.9939   0.9991
## Pos Pred Value         0.9893   0.9828   0.9453   0.9686   0.9958
## Neg Pred Value         0.9982   0.9953   0.9916   0.9921   0.9960
## Prevalence             0.2845   0.1935   0.1744   0.1639   0.1838
## Detection Rate         0.2832   0.1897   0.1675   0.1573   0.1805
## Detection Prevalence   0.2863   0.1930   0.1772   0.1624   0.1812
## Balanced Accuracy      0.9956   0.9881   0.9744   0.9767   0.9905</code></pre>
<p>On the validation dataset the model performs fantastic. The model
still achieves ~98% accuracy with few observations off the diagonal. The
sensitivity of the model is quite high across all classes with .96 being
the lowest. Specificity is .99 across all classes. Thus, the model is
achieving high accuracy across all classes and is not suffering in its
ability to classify one movement over another.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>rfpred<span class="ot">&lt;-</span><span class="fu">predict</span>(rfmod,testpca)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracy on the test set</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(rfpred<span class="sc">==</span>testfilt<span class="sc">$</span>classe)<span class="sc">/</span><span class="fu">nrow</span>(testfilt)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 100</code></pre>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>With the validation set the model performs very well with an accuracy
of ~98%. Thus the model has an out of sample error of 2 percent. Given
the small size of the test set, the model performs with 100 percent
accuracy. Thus this accelerometer data serves as an excellent source of
information to classify the quality of an exercise.</p>
</div>
</div>

   
   
            
      

  <script>
    $(document).ready(function () {

			
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
